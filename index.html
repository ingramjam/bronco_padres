<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>EYB Bronco Manager</title>
    <style>
        :root {
            --primary: #004d40;
            --accent: #d32f2f;
            --warning: #fbc02d;
            --safe: #388e3c;
            --bg: #f4f4f9;
            --card-bg: #ffffff;
            --text: #333;
        }
        body { font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Helvetica, Arial, sans-serif; background: var(--bg); color: var(--text); margin: 0; padding: 0; }
        
        /* Layout */
        .container { max-width: 800px; margin: 0 auto; padding: 20px; padding-bottom: 80px; }
        
        /* Header */
        .header { text-align: center; margin-bottom: 20px; }
        .header h1 { margin: 0; color: var(--primary); font-size: 1.8rem; }
        .header p { margin: 5px 0 0 0; color: #666; font-size: 0.9rem; }

        /* Navigation Tabs */
        .nav-tabs { display: flex; background: white; padding: 10px; border-radius: 12px; box-shadow: 0 2px 5px rgba(0,0,0,0.05); margin-bottom: 20px; position: sticky; top: 10px; z-index: 100; }
        .tab-btn { flex: 1; border: none; background: transparent; padding: 12px; font-size: 1rem; font-weight: bold; color: #888; border-radius: 8px; cursor: pointer; transition: 0.2s; }
        .tab-btn.active { background: var(--primary); color: white; box-shadow: 0 2px 4px rgba(0,0,0,0.2); }

        /* VIEWS */
        .view-section { display: none; }
        .view-section.active { display: block; animation: fadeIn 0.3s; }
        @keyframes fadeIn { from { opacity: 0; transform: translateY(5px); } to { opacity: 1; transform: translateY(0); } }

        /* --- RULES VIEW STYLES --- */
        .search-container { margin-bottom: 15px; }
        input[type="text"] { width: 100%; padding: 15px; border-radius: 8px; border: 1px solid #ccc; font-size: 16px; box-sizing: border-box; }
        
        .dashboard { display: grid; grid-template-columns: repeat(2, 1fr); gap: 10px; margin-bottom: 25px; }
        .stat-card { background: var(--primary); color: white; padding: 15px; border-radius: 8px; text-align: center; }
        .stat-card h3 { margin: 0 0 5px 0; font-size: 0.8rem; opacity: 0.9; text-transform: uppercase; letter-spacing: 0.5px; }
        .stat-card .value { font-size: 1.3rem; font-weight: bold; }
        .stat-card.alert { background: var(--accent); }

        .filters { display: flex; gap: 8px; overflow-x: auto; padding-bottom: 10px; margin-bottom: 15px; -webkit-overflow-scrolling: touch; }
        .filter-btn { background: #e0e0e0; border: none; padding: 8px 14px; border-radius: 20px; white-space: nowrap; cursor: pointer; font-size: 0.9rem; color: #555; }
        .filter-btn.active { background: var(--primary); color: white; }

        .rule-card { background: var(--card-bg); padding: 18px; border-radius: 12px; border-left: 5px solid #ccc; box-shadow: 0 2px 5px rgba(0,0,0,0.05); margin-bottom: 15px; }
        .rule-card.important { border-left-color: var(--accent); }
        .rule-card h2 { margin-top: 0; font-size: 1.1rem; display: flex; justify-content: space-between; align-items: center; color: var(--primary); }
        .rule-card .category-tag { font-size: 0.65rem; background: #eee; padding: 3px 8px; border-radius: 4px; color: #666; font-weight: normal; text-transform: uppercase; }
        .rule-card p { line-height: 1.5; color: #444; margin: 10px 0; }
        .rule-card .source { font-size: 0.75rem; color: #999; font-style: italic; display: block; text-align: right; }

        /* --- PITCH COUNTER STYLES --- */
        .counter-card { background: white; border-radius: 15px; padding: 25px; text-align: center; box-shadow: 0 4px 15px rgba(0,0,0,0.1); }
        
        .pitch-display { font-size: 5rem; font-weight: bold; color: var(--text); line-height: 1; margin: 10px 0; transition: color 0.3s; }
        .pitch-label { color: #888; font-size: 0.9rem; text-transform: uppercase; letter-spacing: 1px; }

        .rest-status { margin: 20px 0; padding: 15px; background: #f8f9fa; border-radius: 10px; border: 1px solid #eee; }
        .rest-days { font-size: 1.5rem; font-weight: bold; color: var(--primary); display: block; margin-bottom: 5px; }
        .next-threshold { font-size: 0.9rem; color: #666; }

        .controls { display: grid; grid-template-columns: 1fr 1fr; gap: 15px; margin-top: 20px; }
        .ctrl-btn { border: none; padding: 20px; border-radius: 12px; font-size: 1.5rem; cursor: pointer; touch-action: manipulation; }
        .btn-minus { background: #e0e0e0; color: #333; }
        .btn-plus { background: var(--primary); color: white; font-weight: bold; box-shadow: 0 4px 0 #00332a; active { transform: translateY(4px); box-shadow: none; } }
        .btn-plus:active { transform: translateY(4px); box-shadow: none; }

        .reset-btn { margin-top: 20px; background: transparent; border: 1px solid #ccc; color: #888; padding: 10px 20px; border-radius: 20px; font-size: 0.9rem; cursor: pointer; }

        /* Threshold Colors */
        .status-0 { color: var(--safe); }
        .status-1 { color: var(--warning); }
        .status-2 { color: #f57f17; }
        .status-3 { color: #e65100; }
        .status-4 { color: var(--accent); }

    </style>
</head>
<body>

<div class="container">
    <div class="header">
        <h1>Bronco Manager</h1>
        <p>Escondido Youth Baseball</p>
    </div>

    <div class="nav-tabs">
        <button class="tab-btn active" onclick="switchTab('rules')">ðŸ“– Rules</button>
        <button class="tab-btn" onclick="switchTab('counter')">âš¾ Pitch Counter</button>
    </div>

    <div id="view-rules" class="view-section active">
        <div class="dashboard">
            <div class="stat-card alert">
                <h3>Max Pitches</h3>
                <div class="value">85</div>
            </div>
            <div class="stat-card">
                <h3>Max Time</h3>
                <div class="value">1:50</div>
            </div>
            <div class="stat-card">
                <h3>Mercy Rule</h3>
                <div class="value">10 run / 5 inn</div>
            </div>
            <div class="stat-card">
                <h3>Min Play</h3>
                <div class="value">Sit 1 / All 1</div>
            </div>
        </div>

        <div class="search-container">
            <input type="text" id="searchInput" placeholder="Search rules (e.g. 'subs', 'mound')...">
        </div>

        <div class="filters" id="filterContainer">
            <button class="filter-btn active" onclick="filterRules('All')">All</button>
            <button class="filter-btn" onclick="filterRules('Pitching')">Pitching</button>
            <button class="filter-btn" onclick="filterRules('Game Time')">Time/Mercy</button>
            <button class="filter-btn" onclick="filterRules('Roster & Batting')">Roster</button>
            <button class="filter-btn" onclick="filterRules('Base Running')">Running</button>
            <button class="filter-btn" onclick="filterRules('Field Prep')">Field Prep</button>
        </div>

        <div id="rulesContainer">
            </div>
    </div>

    <div id="view-counter" class="view-section">
        <div class="counter-card">
            <div class="pitch-label">Current Pitch Count</div>
            <div class="pitch-display status-0" id="countDisplay">0</div>
            
            <div class="rest-status">
                <span class="rest-days" id="restDisplay">0 Days Rest</span>
                <span class="next-threshold" id="thresholdDisplay">20 pitches until 1 Day Rest</span>
            </div>

            <div class="controls">
                <button class="ctrl-btn btn-minus" onclick="updatePitch(-1)">âˆ’</button>
                <button class="ctrl-btn btn-plus" onclick="updatePitch(1)">+ Pitch</button>
            </div>

            <button class="reset-btn" onclick="if(confirm('Reset counter to 0?')) { updatePitch(-999); }">Reset Counter</button>
        </div>
        
        <div style="margin-top: 20px; font-size: 0.85rem; color: #666; padding: 0 10px;">
            <strong>Bronco (11-12) Rest Rules:</strong><br>
            â€¢ 1-20: 0 Days<br>
            â€¢ 21-35: 1 Day<br>
            â€¢ 36-50: 2 Days<br>
            â€¢ 51-65: 3 Days<br>
            â€¢ 66+: 4 Days<br>
            â€¢ <strong>MAX: 85</strong>
        </div>
    </div>

</div>

<script>
    // --- APP LOGIC ---

    // 1. DATA: RULES
    const broncoRules = [
        { category: "Pitching", title: "Daily Max Pitches", content: "Pitchers may pitch a maximum of 85 pitches per day. [cite_start]If they hit the limit during a batter, they may finish that batter.", important: true, source: "Appx A-5, Sec 5.A [cite: 1650]" },
        { category: "Pitching", title: "Rest Days (Ages 11-12)", content: "1-20: 0 Days | 21-35: 1 Day | 36-50: 2 Days | 51-65: 3 Days | [cite_start]66+: 4 Days.", important: true, source: "Appx A-5, Sec 5 Table [cite: 1655]" },
        { category: "Pitching", title: "Pitcher Removal", content: "Once removed from the mound, a pitcher cannot return to pitch. [cite_start]Remove immediately if they hit 3 batters in one game.", important: true, source: "Appx A-5, Sec 5.A & 5.C [cite: 1661, 1664]" },
        [cite_start]{ category: "Pitching", title: "Mound Visits", content: "Two visits in one inning = mandatory pitching change (except for injury).", important: false, source: "Appx A-5, Sec 5.B [cite: 1662]" },
        { category: "Game Time", title: "Duration & Limits", content: "Regulation: 7 innings. No new inning after 1 hr 50 mins. [cite_start]Hard stop 9:45 PM.", important: true, source: "Appx A-5, Sec 4 [cite: 1635-1636, 1641]" },
        [cite_start]{ category: "Game Time", title: "Mercy Rule", content: "10 run lead after 5 complete innings (4 Â½ if Home leads).", important: true, source: "Appx A-5, Sec 4.G [cite: 1646]" },
        { category: "Roster & Batting", title: "Batting Order", content: "Continuous batting order. [cite_start]Everyone bats.", important: false, source: "Appx A-5, Sec 6.A [cite: 1667]" },
        [cite_start]{ category: "Roster & Batting", title: "Minimum Play", content: "No player sits 2 innings until all have sat 1. No player sits 3 until all have sat 2. Must play 1 inning in infield (Rec only).", important: true, source: "Appx A-5, Sec 4.F [cite: 1642-1644]" },
        { category: "Base Running", title: "Courtesy Runners", content: "Allowed for Catcher w/ 2 outs. [cite_start]Must be last recorded out.", important: false, source: "Appx A-5, Sec 7.A [cite: 1669]" },
        { category: "Base Running", title: "Slide or Avoid", content: "Must slide or avoid contact. [cite_start]Malicious contact = ejection & out.", important: true, source: "Appx A-5, Sec 9 [cite: 1676, 1680]" },
        { category: "Field Prep", title: "Home Team Duties", content: "Official Scorebook. Rake plate/mound. Chalk lines. Bases. [cite_start]Clean Home dugout.", important: false, source: "Sec XV, 1.A [cite: 679-685]" },
        { category: "Field Prep", title: "Visiting Team Duties", content: "Scoreboard Operator. Drag field (End of game). [cite_start]Clean Visitor dugout.", important: false, source: "Sec XV, 1.B [cite: 687-693]" }
    ];

    // 2. RULES FUNCTIONS
    const rulesContainer = document.getElementById('rulesContainer');
    const searchInput = document.getElementById('searchInput');
    let currentCategory = 'All';

    function renderRules(rules) {
        rulesContainer.innerHTML = rules.map(rule => `
            <div class="rule-card ${rule.important ? 'important' : ''}">
                <h2>${rule.title} <span class="category-tag">${rule.category}</span></h2>
                <p>${rule.content}</p>
                <div class="source">Source: ${rule.source}</div>
            </div>
        `).join('');
    }

    function filterRules(category) {
        currentCategory = category;
        document.querySelectorAll('.filter-btn').forEach(btn => {
            btn.classList.toggle('active', btn.innerText === category || (category === 'Time/Mercy' && btn.innerText === 'Time/Mercy'));
        });
        applyFilters();
    }

    function applyFilters() {
        const query = searchInput.value.toLowerCase();
        const filtered = broncoRules.filter(rule => {
            const matchesCategory = currentCategory === 'All' || rule.category === currentCategory;
            const matchesSearch = rule.title.toLowerCase().includes(query) || 
                                  rule.content.toLowerCase().includes(query) ||
                                  rule.category.toLowerCase().includes(query);
            return matchesCategory && matchesSearch;
        });
        renderRules(filtered);
    }

    searchInput.addEventListener('input', applyFilters);
    renderRules(broncoRules); // Init rules

    // 3. TAB LOGIC
    function switchTab(tabId) {
        // Hide all views
        document.querySelectorAll('.view-section').forEach(el => el.classList.remove('active'));
        document.querySelectorAll('.tab-btn').forEach(el => el.classList.remove('active'));

        // Show selected
        document.getElementById('view-' + tabId).classList.add('active');
        // Highlight button (simple logic for 2 buttons)
        const btnIndex = tabId === 'rules' ? 0 : 1;
        document.querySelectorAll('.tab-btn')[btnIndex].classList.add('active');
    }

    // 4. PITCH COUNTER LOGIC
    let pitchCount = 0;
    const maxPitches = 85;
    const thresholds = [
        { limit: 20, rest: "0 Days", next: "1 Day" },
        { limit: 35, rest: "1 Day", next: "2 Days" },
        { limit: 50, rest: "2 Days", next: "3 Days" },
        { limit: 65, rest: "3 Days", next: "4 Days" },
        { limit: 85, rest: "4 Days", next: "MAX" }
    ];

    function updatePitch(change) {
        if (change === -999) pitchCount = 0;
        else pitchCount += change;
        
        if (pitchCount < 0) pitchCount = 0;
        
        // Update Display
        const countDisplay = document.getElementById('countDisplay');
        const restDisplay = document.getElementById('restDisplay');
        const thresholdDisplay = document.getElementById('thresholdDisplay');
        
        countDisplay.innerText = pitchCount;

        // Calculate Stats
        let currentStatus = thresholds[0];
        let nextThreshold = thresholds[0].limit;
        let colorClass = "status-0";

        if (pitchCount > 65) { currentStatus = thresholds[4]; nextThreshold = 85; colorClass = "status-4"; }
        else if (pitchCount > 50) { currentStatus = thresholds[3]; nextThreshold = 65; colorClass = "status-3"; }
        else if (pitchCount > 35) { currentStatus = thresholds[2]; nextThreshold = 50; colorClass = "status-2"; }
        else if (pitchCount > 20) { currentStatus = thresholds[1]; nextThreshold = 35; colorClass = "status-1"; }

        // Alert text logic
        if (pitchCount >= 85) {
            restDisplay.innerText = "MAX LIMIT REACHED";
            thresholdDisplay.innerText = "Finish current batter only.";
            colorClass = "status-4";
        } else {
            restDisplay.innerText = currentStatus.rest + " Rest Required";
            const pitchesLeft = nextThreshold - pitchCount;
            thresholdDisplay.innerText = `${pitchesLeft} pitches until ${currentStatus.next} Rest`;
        }

        // Apply Colors
        countDisplay.className = `pitch-display ${colorClass}`;
    }

    // Init Counter
    updatePitch(0);

</script>
</body>
</html>
